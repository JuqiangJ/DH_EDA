<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 6 From data visualization to statistical modelling | A Introduction to Eploratory Data Analysis with R</title>
  <meta name="description" content="This is an introduction to Eploratory Data Analysis with R tutorial for DH summer school 2019 at Newcastle.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 6 From data visualization to statistical modelling | A Introduction to Eploratory Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an introduction to Eploratory Data Analysis with R tutorial for DH summer school 2019 at Newcastle." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 From data visualization to statistical modelling | A Introduction to Eploratory Data Analysis with R" />
  
  <meta name="twitter:description" content="This is an introduction to Eploratory Data Analysis with R tutorial for DH summer school 2019 at Newcastle." />
  

<meta name="author" content="Juqiang Chen">


<meta name="date" content="2019-12-01">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="covariation.html">
<link rel="next" href="statistical-modeling-and-model-interpretation.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Exploratory Data Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installing-r-and-r-studio"><i class="fa fa-check"></i><b>1.1</b> Installing R and R studio</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#install-packages-and-library-packages"><i class="fa fa-check"></i><b>1.2</b> Install packages and library packages</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#data-and-workbook"><i class="fa fa-check"></i><b>1.3</b> Data and workbook</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Basic data structures in R</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#types-of-variables-a-taxonomy"><i class="fa fa-check"></i><b>2.1</b> Types of variables: A taxonomy</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#categorical-variables-ordinal-vs.norminal"><i class="fa fa-check"></i><b>2.1.1</b> Categorical variables: ordinal vs. norminal</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#numeric-variables-discrete-or-continuous"><i class="fa fa-check"></i><b>2.1.2</b> Numeric variables: discrete or continuous</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#d-data-structure-vectors"><i class="fa fa-check"></i><b>2.2</b> 1D data structure: vectors</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#creating-vectors"><i class="fa fa-check"></i><b>2.2.1</b> Creating vectors</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#creating-list-objects"><i class="fa fa-check"></i><b>2.2.2</b> Creating list objects</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#d-data-structures-matrice-and-data-frames"><i class="fa fa-check"></i><b>2.3</b> 2D data structures: matrice and data frames</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#what-if-i-want-to-change-column-names-or-add-variable-to-the-df"><i class="fa fa-check"></i><b>2.3.1</b> what if I want to change column names or add variable to the df?</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#subsetting-dataframes"><i class="fa fa-check"></i><b>2.3.2</b> Subsetting dataframes</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#summary"><i class="fa fa-check"></i><b>2.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="what-is-eda.html"><a href="what-is-eda.html"><i class="fa fa-check"></i><b>3</b> What is EDA?</a><ul>
<li class="chapter" data-level="3.1" data-path="what-is-eda.html"><a href="what-is-eda.html#definition-from-wikipedia"><i class="fa fa-check"></i><b>3.1</b> Definition (from Wikipedia)</a></li>
<li class="chapter" data-level="3.2" data-path="what-is-eda.html"><a href="what-is-eda.html#the-objectives-of-eda"><i class="fa fa-check"></i><b>3.2</b> The objectives of EDA</a></li>
<li class="chapter" data-level="3.3" data-path="what-is-eda.html"><a href="what-is-eda.html#data-analysis-workflow"><i class="fa fa-check"></i><b>3.3</b> Data analysis workflow</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="variation.html"><a href="variation.html"><i class="fa fa-check"></i><b>4</b> Variation</a><ul>
<li class="chapter" data-level="4.1" data-path="variation.html"><a href="variation.html#categorical-variable"><i class="fa fa-check"></i><b>4.1</b> Categorical variable</a><ul>
<li class="chapter" data-level="4.1.1" data-path="variation.html"><a href="variation.html#absolute-v.s-relative-frequency"><i class="fa fa-check"></i><b>4.1.1</b> Absolute v.s relative frequency?</a></li>
<li class="chapter" data-level="4.1.2" data-path="variation.html"><a href="variation.html#frequency-distributions"><i class="fa fa-check"></i><b>4.1.2</b> Frequency distributions</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="variation.html"><a href="variation.html#continous-variable"><i class="fa fa-check"></i><b>4.2</b> Continous variable</a><ul>
<li class="chapter" data-level="4.2.1" data-path="variation.html"><a href="variation.html#central-tendency"><i class="fa fa-check"></i><b>4.2.1</b> Central tendency</a></li>
<li class="chapter" data-level="4.2.2" data-path="variation.html"><a href="variation.html#measures-of-spread"><i class="fa fa-check"></i><b>4.2.2</b> Measures of Spread</a></li>
<li class="chapter" data-level="4.2.3" data-path="variation.html"><a href="variation.html#confidence-interval"><i class="fa fa-check"></i><b>4.2.3</b> Confidence interval</a></li>
<li class="chapter" data-level="4.2.4" data-path="variation.html"><a href="variation.html#unusual-values"><i class="fa fa-check"></i><b>4.2.4</b> Unusual values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="covariation.html"><a href="covariation.html"><i class="fa fa-check"></i><b>5</b> Covariation</a><ul>
<li class="chapter" data-level="5.1" data-path="covariation.html"><a href="covariation.html#two-categorical-variables"><i class="fa fa-check"></i><b>5.1</b> Two categorical variables</a><ul>
<li class="chapter" data-level="5.1.1" data-path="covariation.html"><a href="covariation.html#contingency-table"><i class="fa fa-check"></i><b>5.1.1</b> Contingency table</a></li>
<li class="chapter" data-level="5.1.2" data-path="covariation.html"><a href="covariation.html#tile-plot"><i class="fa fa-check"></i><b>5.1.2</b> Tile plot</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="covariation.html"><a href="covariation.html#categorical-continuous-variable"><i class="fa fa-check"></i><b>5.2</b> Categorical + continuous variable</a><ul>
<li class="chapter" data-level="5.2.1" data-path="covariation.html"><a href="covariation.html#summary-table"><i class="fa fa-check"></i><b>5.2.1</b> Summary table</a></li>
<li class="chapter" data-level="5.2.2" data-path="covariation.html"><a href="covariation.html#central-tendency-mean-bar-plots"><i class="fa fa-check"></i><b>5.2.2</b> Central tendency (mean): Bar plots</a></li>
<li class="chapter" data-level="5.2.3" data-path="covariation.html"><a href="covariation.html#distribution-density-plot"><i class="fa fa-check"></i><b>5.2.3</b> Distribution: density plot</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="covariation.html"><a href="covariation.html#two-continuous-variables"><i class="fa fa-check"></i><b>5.3</b> Two continuous variables</a><ul>
<li class="chapter" data-level="5.3.1" data-path="covariation.html"><a href="covariation.html#scatter-plots"><i class="fa fa-check"></i><b>5.3.1</b> Scatter plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="from-data-visualization-to-statistical-modelling.html"><a href="from-data-visualization-to-statistical-modelling.html"><i class="fa fa-check"></i><b>6</b> From data visualization to statistical modelling</a><ul>
<li class="chapter" data-level="6.1" data-path="from-data-visualization-to-statistical-modelling.html"><a href="from-data-visualization-to-statistical-modelling.html#two-continuousnumerical-variables"><i class="fa fa-check"></i><b>6.1</b> Two continuous/numerical variables</a><ul>
<li class="chapter" data-level="6.1.1" data-path="from-data-visualization-to-statistical-modelling.html"><a href="from-data-visualization-to-statistical-modelling.html#t-testanova-categorical-independent-variable-continuous-dependent-variable"><i class="fa fa-check"></i><b>6.1.1</b> T-test/ANOVA: categorical (independent variable )+ continuous (dependent variable)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistical-modeling-and-model-interpretation.html"><a href="statistical-modeling-and-model-interpretation.html"><i class="fa fa-check"></i><b>7</b> Statistical Modeling and Model Interpretation</a><ul>
<li class="chapter" data-level="7.1" data-path="statistical-modeling-and-model-interpretation.html"><a href="statistical-modeling-and-model-interpretation.html#parametric-statistical-tests"><i class="fa fa-check"></i><b>7.1</b> Parametric statistical tests</a></li>
<li class="chapter" data-level="7.2" data-path="statistical-modeling-and-model-interpretation.html"><a href="statistical-modeling-and-model-interpretation.html#formal-tests-for-homogeneity-of-variance"><i class="fa fa-check"></i><b>7.2</b> formal tests for homogeneity of variance</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>8</b> Resources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Introduction to Eploratory Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="from-data-visualization-to-statistical-modelling" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> From data visualization to statistical modelling</h1>
<p>Patterns in the data provide clues about relationship or covariation.Now that we know how to visualize the various relationships, we can proceed to learn more about how to formally test the relationship.</p>
<p>Statistical models are tools for extracting patterns out of data.</p>
<p>Statistics represent a common method of presenting information helping us to understand what the data are telling us.</p>
<ul>
<li><p><em>Descriptive (or summary) statistics</em> summarise the raw data and allow data users to interpret a dataset more easily.Descriptive statistics can describe the shape, centre and spread of a dataset.</p></li>
<li><p><em>Inferential statistics</em> are used to infer conclusions about a population from a sample of that population. Inferential statistics are the result of techniques that use the data collected from a sample to make generalisations about the whole population from which the sample was taken. Inferential statistics include <em>estimation</em> (An estimate is a value that is inferred for a population based on data collected from a sample of units from that population), and <em>hypothesis testing</em>.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;img/stats.png&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:stats"></span>
<img src="img/stats.png" alt="stats" width="100%" />
<p class="caption">
Figure 6.1: stats
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#source:from slides, Dr.Russell Thomson, Statistical Consultant, Centre for Research in Mathematics and Graduate Research School</span></code></pre></div>
<div id="two-continuousnumerical-variables" class="section level2">
<h2><span class="header-section-number">6.1</span> Two continuous/numerical variables</h2>
<p>The techique we used here is called <em>Simpler linear regression</em>, where there is one dependent variable (continuous) and one independent variable (continuous). When there are more than one independent variable (continuous), you need to look for something called <em>Multiple linear regression</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(faithful)</code></pre></div>
<pre><code>##   eruptions waiting
## 1     3.600      79
## 2     1.800      54
## 3     3.333      74
## 4     2.283      62
## 5     4.533      85
## 6     2.883      55</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(faithful)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(eruptions, waiting))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-38-1.png" width="672" /> <em>Correlation</em> and <em>linear regression</em> each explore the relationship between two quantitative variables. (Salvatore S. Mangiafico)</p>
<p>Correlation determines if one variable varies systematically as another variable changes. It does not specify that one variable is the dependent variable and the other is the independent variable. Often, it is useful to look at which variables are correlated to others in a data set, and it is especially useful to see which variables correlate to a particular variable of interest.</p>
<p>In contrast, linear regression specifies one variable as the independent variable and another as the dependent variable. The resultant model relates the variables with a linear relationship.</p>
<p>The tests associated with linear regression are parametric and assume normality, homoscedasticity, and independence of residuals, as well as a linear relationship between the two variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(psych)){<span class="kw">install.packages</span>(<span class="st">&quot;psych&quot;</span>)}</code></pre></div>
<pre><code>## Loading required package: psych</code></pre>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rcompanion&#39;:
## 
##     phi</code></pre>
<pre><code>## The following object is masked from &#39;package:Hmisc&#39;:
## 
##     describe</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(PerformanceAnalytics)){<span class="kw">install.packages</span>(<span class="st">&quot;PerformanceAnalytics&quot;</span>)}</code></pre></div>
<pre><code>## Loading required package: PerformanceAnalytics</code></pre>
<pre><code>## Loading required package: xts</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## 
## Attaching package: &#39;xts&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     first, last</code></pre>
<pre><code>## 
## Attaching package: &#39;PerformanceAnalytics&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     legend</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(ggplot2)){<span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)}
<span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(rcompanion)){<span class="kw">install.packages</span>(<span class="st">&quot;rcompanion&quot;</span>)}

<span class="kw">library</span>(psych)
<span class="kw">pairs</span>(<span class="dt">data=</span>faithful,
    <span class="op">~</span><span class="st"> </span>eruptions <span class="op">+</span><span class="st"> </span>waiting)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(<span class="dt">data=</span>iris,
    <span class="op">~</span><span class="st"> </span>Sepal.Length <span class="op">+</span><span class="st"> </span>Sepal.Width <span class="op">+</span><span class="st"> </span>Petal.Length <span class="op">+</span>Petal.Width)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-39-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">corr.test</span>(faithful,
          <span class="dt">use    =</span> <span class="st">&quot;pairwise&quot;</span>,
          <span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>,
          <span class="dt">adjust =</span> <span class="st">&quot;none&quot;</span>)</code></pre></div>
<pre><code>## Call:corr.test(x = faithful, use = &quot;pairwise&quot;, method = &quot;pearson&quot;, 
##     adjust = &quot;none&quot;)
## Correlation matrix 
##           eruptions waiting
## eruptions       1.0     0.9
## waiting         0.9     1.0
## Sample Size 
## [1] 272
## Probability values (Entries above the diagonal are adjusted for multiple tests.) 
##           eruptions waiting
## eruptions         0       0
## waiting           0       0
## 
##  To see confidence intervals of the correlations, print with the short=FALSE option</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(PerformanceAnalytics)

<span class="kw">chart.Correlation</span>(faithful,
                   <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>,
                   <span class="dt">histogram=</span><span class="ot">TRUE</span>,
                   <span class="dt">pch=</span><span class="dv">16</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-39-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chart.Correlation</span>(faithful,
                   <span class="dt">method=</span><span class="st">&quot;kendall&quot;</span>,
                   <span class="dt">histogram=</span><span class="ot">TRUE</span>,
                   <span class="dt">pch=</span><span class="dv">16</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-39-4.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chart.Correlation</span>(faithful,
                   <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>,
                   <span class="dt">histogram=</span><span class="ot">TRUE</span>,
                   <span class="dt">pch=</span><span class="dv">16</span>)</code></pre></div>
<pre><code>## Warning in cor.test.default(as.numeric(x), as.numeric(y), method = method):
## Cannot compute exact p-value with ties</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-39-5.png" width="672" /> The statistics r, rho, and tau are used as effect sizes for Pearson, Spearman, and Kendall regression, respectively. These statistics vary from –1 to 1, with 0 indicating no correlation, 1 indicating a perfect positive correlation, and –1 indicating a perfect negative correlation. Like other effect size statistics, these statistics are not affected by sample size.</p>
<p>Interpretation of effect sizes necessarily varies by discipline and the expectations of the experiment. They should not be considered universal. An interpretation of r is given by Cohen (1988). It is probably reasonable to use similar interpretations for rho and tau.</p>
<ul>
<li><p>small: 0.10 – &lt; 0.30</p></li>
<li><p>medium: 0.30 – &lt; 0.50</p></li>
<li><p>large: ≥ 0.50</p></li>
</ul>
<p>The test used for <em>Pearson correlation</em> is a parametric analysis that requires that the relationship between the variables is linear, and that the data be bivariate normal. Variables should be interval/ratio. The test is sensitive to outliers.</p>
<p>The correlation coefficient, r, can range from +1 to –1, with +1 being a perfect positive correlation and –1 being a perfect negative correlation. An r of 0 represents no correlation whatsoever. The hypothesis test determines if the r value is significantly different from 0.</p>
<p><em>Kendall correlation </em>is considered a nonparametric analysis. It is a rank-based test that does not require assumptions about the distribution of the data. Variables can be interval/ratio or ordinal.</p>
<p>The correlation coefficient from the test is tau, which can range from +1 to –1, with +1 being a perfect positive correlation and –1 being a perfect negative correlation. A tau of 0 represents no correlation whatsoever. The hypothesis test determines if the tau value is significantly different from 0.</p>
<p>As a technical note, the cor.test function in R calculates tau-b, which handles ties in ranks well.</p>
<p>The test is relatively robust to outliers in the data. The test is sometimes cited for being reliable when there are small number of samples or when there are many ties in ranks.</p>
<p><em>Spearman correlation</em> is considered a nonparametric analysis. It is a rank-based test that does not require assumptions about the distribution of the data. Variables can be interval/ratio or ordinal.</p>
<p>The correlation coefficient from the test, rho, can range from +1 to –1, with +1 being a perfect positive correlation and –1 being a perfect negative correlation. A rho of 0 represents no correlation whatsoever. The hypothesis test determines if the rho value is significantly different from 0.</p>
<p>Spearman correlation is probably most often used with ordinal data. It tests for a monotonic relationship between the variables. It is relatively robust to outliers in the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>( <span class="op">~</span><span class="st"> </span>eruptions <span class="op">+</span><span class="st"> </span>waiting,
         <span class="dt">data=</span>faithful,
         <span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  eruptions and waiting
## t = 34.089, df = 270, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.8756964 0.9210652
## sample estimates:
##       cor 
## 0.9008112</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the results report the p-value for the hypothesis test as well as the r value, written as cor, 0.849.</span>

<span class="kw">cor.test</span>( <span class="op">~</span><span class="st"> </span>eruptions <span class="op">+</span><span class="st"> </span>waiting,
         <span class="dt">data=</span>faithful,
         <span class="dt">method =</span> <span class="st">&quot;kendall&quot;</span>)</code></pre></div>
<pre><code>## 
##  Kendall&#39;s rank correlation tau
## 
## data:  eruptions and waiting
## z = 13.902, p-value &lt; 2.2e-16
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##       tau 
## 0.5747674</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>( <span class="op">~</span><span class="st"> </span>eruptions <span class="op">+</span><span class="st"> </span>waiting,
         <span class="dt">data=</span>faithful,
         <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</code></pre></div>
<pre><code>## Warning in cor.test.default(x = c(3.6, 1.8, 3.333, 2.283, 4.533, 2.883, :
## Cannot compute exact p-value with ties</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  eruptions and waiting
## S = 744660, p-value &lt; 2.2e-16
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.7779721</code></pre>
<div id="linear-regression" class="section level4">
<h4><span class="header-section-number">6.1.0.1</span> Linear regression</h4>
<p>Linear regression is a very common approach to model the relationship between two interval/ratio variables. The method assumes that there is a linear relationship between the dependent variable and the independent variable, and finds a best fit model for this relationship.</p>
<p>Interpretation of coefficients The outcome of linear regression includes estimating the <em>intercept</em> and the <em>slope</em> of the linear model.</p>
<p>Multiple, nominal, and ordinal independent variables If there are multiple independent variables of interval/ratio type in the model, then linear regression expands to multiple regression. The polynomial regression example in this chapter is a form of multiple regression.</p>
<p>If the independent variable were of nominal type, then the linear regression would become a <em>one-way analysis of variance</em>.</p>
<p>Handling independent variables of ordinal type can be complicated. Often they are treated as either nominal type or interval/ratio type, although there are drawbacks to each approach.</p>
<p>Assumptions Linear regression assumes a linear relationship between the two variables, normality of the residuals, independence of the residuals, and homoscedasticity of residuals.</p>
<p>Linear regression can be performed with the lm function, which was the same function we used for analysis of variance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model =<span class="st"> </span><span class="kw">lm</span>(eruptions <span class="op">~</span><span class="st"> </span>waiting,
           <span class="dt">data =</span> faithful)

<span class="kw">summary</span>(model)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = eruptions ~ waiting, data = faithful)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.29917 -0.37689  0.03508  0.34909  1.19329 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1.874016   0.160143  -11.70   &lt;2e-16 ***
## waiting      0.075628   0.002219   34.09   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4965 on 270 degrees of freedom
## Multiple R-squared:  0.8115, Adjusted R-squared:  0.8108 
## F-statistic:  1162 on 1 and 270 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(eruptions <span class="op">~</span><span class="st"> </span>waiting,
     <span class="dt">data=</span>faithful,
     <span class="dt">pch=</span><span class="dv">16</span>,
     <span class="dt">xlab =</span> <span class="st">&quot;waiting&quot;</span>,
     <span class="dt">ylab =</span> <span class="st">&quot;eruptions&quot;</span>)

<span class="kw">abline</span>(model,
       <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,
       <span class="dt">lwd =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="kw">residuals</span>(model)


<span class="kw">library</span>(rcompanion)

<span class="kw">plotNormalHistogram</span>(x)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-41-2.png" width="672" /></p>
<p>The summary function for lm model objects includes estimates for model parameters (intercept and slope), as well as an r-squared value for the model and p-value for the model.</p>
<p>How to read the model? The model produces a coefficient for the intercept (-1.87) and a coefficient for the slope (0.07);Each coefficient comes with three other numbers: its standard error, a t-value, and a p-value. The p-value tells us whether the coefficient is significantly different from zero.</p>
<p>If the coefficient for a predictor is zero, there is no relation at all between the predictor and the dependent variable, in which case it is worthless as a predictor. In order to ascertain whether a coefficient is significantly different from zero, and hence potentially useful, a two-tailed t-test is carried out, using the t-value and <em>the associated degrees of freedom</em>.</p>
<p>The t-value itself is the value of the coefficient divided by its standard error. This standard error is a measure of how sure we are about the estimate of the coefficient. The smaller the standard error, the smaller the confidence interval around the estimate, the less likely it is that zero will be included in the acceptance region, and hence the smaller the probability that it might just as well be zero.</p>
<p>The residual standard error is a measure of how unsuccessful the model is; it gauges the variability in the dependent variable that we can’t handle through the predictor variables. The better a model is, the smaller its residual standard error will be.</p>
<p>The multiple R-squared equals 0.8115. This R-squared is the squared correlation coefficient, r2, which quantifies, on a scale from 0 to 1, the proportion of the variance that the model explains.</p>
</div>
<div id="t-testanova-categorical-independent-variable-continuous-dependent-variable" class="section level3">
<h3><span class="header-section-number">6.1.1</span> T-test/ANOVA: categorical (independent variable )+ continuous (dependent variable)</h3>
<p>The two-sample unpaired t-test is a commonly used test that compares the means of two samples.</p>
<p>• Data for each population are normally distributed</p>
<p>• For Student’s t-test, the two samples need to have the same variance. However, Welch’s t-test, which is used by default in R, does not assume equal variances.</p>
<p>• Observations between groups are independent. That is, not paired or repeated measures data</p>
<p>• Moderate skewness is permissible if the data distribution is unimodal without outliers</p>
<p>Hypotheses • Null hypothesis: The means of the populations from which the data were sampled for each group are equal.</p>
<p>• Alternative hypothesis (two-sided): The means of the populations from which the data were sampled for each group are not equal.</p>
<p>Interpretation Reporting significant results as “Mean of variable Y for group A was different than that for group B.” is acceptable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># simulating the data</span>
id =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">100</span>)
temp1 =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;f&quot;</span>,<span class="st">&quot;m&quot;</span>)
gender =<span class="st">  </span><span class="kw">sample</span>(temp1, <span class="dt">size =</span> <span class="dv">100</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
a =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">80</span>, <span class="dt">sd =</span> <span class="dv">4</span>) 
b =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">60</span>, <span class="dt">sd =</span> <span class="dv">4</span>) 
c =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">85</span>, <span class="dt">sd =</span> <span class="dv">4</span>) 
d =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>), <span class="dt">times =</span> <span class="dv">25</span>) 
df =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> id, <span class="dt">sex =</span> gender, <span class="dt">chinese =</span> a, <span class="dt">math =</span> b, <span class="dt">english =</span> c, <span class="dt">class =</span> d)
df<span class="op">$</span>class =<span class="st"> </span><span class="kw">as.factor</span>(df<span class="op">$</span>class)

<span class="co"># test if chinese is significantly different from </span>
<span class="co">#distribution tests</span>

<span class="kw">summary</span>(df<span class="op">$</span>class)</code></pre></div>
<pre><code>##  1  2  3  4 
## 25 25 25 25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#visualization</span>
<span class="kw">plot</span>(<span class="kw">density</span>(df<span class="op">$</span>chinese))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqnorm</span>(df<span class="op">$</span>chinese)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-42-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#formal tests</span>
<span class="co">#null hypothesis: the distribution is normal</span>
<span class="kw">shapiro.test</span>(df<span class="op">$</span>chinese)</code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  df$chinese
## W = 0.99287, p-value = 0.8799</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ks.test</span>(df<span class="op">$</span>chinese, <span class="st">&quot;pnorm&quot;</span>, <span class="kw">mean</span>(df<span class="op">$</span>chinese), <span class="kw">sd</span>(df<span class="op">$</span>chinese))</code></pre></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  df$chinese
## D = 0.047704, p-value = 0.9768
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#one sample t-test: one group and a fixed value</span>
<span class="kw">mean</span>(df<span class="op">$</span>chinese)</code></pre></div>
<pre><code>## [1] 80.51748</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(df<span class="op">$</span>chinese, <span class="dt">mu =</span> <span class="dv">78</span>)</code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  df$chinese
## t = 6.9555, df = 99, p-value = 3.828e-10
## alternative hypothesis: true mean is not equal to 78
## 95 percent confidence interval:
##  79.79931 81.23565
## sample estimates:
## mean of x 
##  80.51748</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(df<span class="op">$</span>chinese, <span class="dt">mu =</span> <span class="dv">78</span>, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>)</code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  df$chinese
## t = 6.9555, df = 99, p-value = 1.914e-10
## alternative hypothesis: true mean is greater than 78
## 95 percent confidence interval:
##  79.91651      Inf
## sample estimates:
## mean of x 
##  80.51748</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(df<span class="op">$</span>chinese, <span class="dt">mu =</span> <span class="dv">78</span>, <span class="dt">alternative =</span> <span class="st">&quot;less&quot;</span>)</code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  df$chinese
## t = 6.9555, df = 99, p-value = 1
## alternative hypothesis: true mean is less than 78
## 95 percent confidence interval:
##      -Inf 81.11845
## sample estimates:
## mean of x 
##  80.51748</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wilcox.test</span>(df<span class="op">$</span>chinese, <span class="dt">mu =</span> <span class="dv">78</span>)<span class="co"># skewed distributions</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank test with continuity correction
## 
## data:  df$chinese
## V = 4260, p-value = 2.465e-09
## alternative hypothesis: true location is not equal to 78</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#probabilities of the things counted</span>
count =<span class="st"> </span><span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">45</span>, <span class="dv">67</span>,<span class="dv">65</span>,<span class="dv">40</span>,<span class="dv">89</span>,<span class="dv">36</span>)
<span class="kw">chisq.test</span>(count)</code></pre></div>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  count
## X-squared = 58.548, df = 6, p-value = 8.873e-11</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#testing two groups</span>
<span class="co">#independent sample t-test v.s. paired sample t-test</span>
<span class="co">#independent sample t-test---compare means</span>
class1 =<span class="st"> </span>df[df<span class="op">$</span>class <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, ]<span class="op">$</span>chinese
class2 =<span class="st"> </span>df[df<span class="op">$</span>class <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, ]<span class="op">$</span>chinese
<span class="kw">t.test</span>(class1,class2)</code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  class1 and class2
## t = 1.9713, df = 47.483, p-value = 0.05453
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.04379575  4.37193900
## sample estimates:
## mean of x mean of y 
##  81.57151  79.40744</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wilcox.test</span>(class1,class2)<span class="co">#not normally distributed</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test
## 
## data:  class1 and class2
## W = 433, p-value = 0.01895
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var.test</span>(class1,class2)<span class="co">#compare variance</span></code></pre></div>
<pre><code>## 
##  F test to compare two variances
## 
## data:  class1 and class2
## F = 1.233, num df = 24, denom df = 24, p-value = 0.612
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  0.5433242 2.7979127
## sample estimates:
## ratio of variances 
##           1.232953</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#paired sample t-test</span>
<span class="kw">t.test</span>(df<span class="op">$</span>chinese, df<span class="op">$</span>math, <span class="dt">paired =</span> T)</code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  df$chinese and df$math
## t = 44.201, df = 99, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  20.05026 21.93500
## sample estimates:
## mean of the differences 
##                20.99263</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wilcox.test</span>(df<span class="op">$</span>chinese, df<span class="op">$</span>math, <span class="dt">paired =</span> T)</code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank test with continuity correction
## 
## data:  df$chinese and df$math
## V = 5050, p-value &lt; 2.2e-16
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Analysis of Variance: ANOVA</span>

<span class="co">#Question: is there a difference between four classes?</span>

dif_class =<span class="st"> </span><span class="kw">aov</span> (chinese <span class="op">~</span><span class="st"> </span>class, <span class="dt">data =</span> df)
<span class="kw">summary</span>(dif_class)</code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## class        3   65.2   21.73   1.694  0.174
## Residuals   96 1231.7   12.83</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#How to report: there is a significant difference among different classes in terms of their Chinese scores, F (3, 96) = 0.87, p = .46.</span>

<span class="co">#the problem of multiple comparision</span>
<span class="co">#Bonferroni correction: a/n</span>
<span class="co">#Tukey&#39;s Honestly Significant difference: assuming the means for each level of the factor should be based on equal numbers of observation.</span>


<span class="co">#how is the difference like?</span>
<span class="kw">TukeyHSD</span>(dif_class)</code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = chinese ~ class, data = df)
## 
## $class
##           diff       lwr      upr     p adj
## 2-1 -2.1640716 -4.813023 0.484880 0.1491745
## 3-1 -0.6634398 -3.312391 1.985512 0.9136071
## 4-1 -1.3886077 -4.037559 1.260344 0.5207703
## 3-2  1.5006319 -1.148320 4.149583 0.4527894
## 4-2  0.7754640 -1.873488 3.424416 0.8698007
## 4-3 -0.7251679 -3.374119 1.923784 0.8906122</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#diff= the difference in the means</span>
<span class="co">#lwr = the lower end points of the confidence interval</span>
<span class="co"># p adj = adjusted p value</span>

<span class="kw">plot</span>(<span class="kw">TukeyHSD</span>(dif_class))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-42-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#two-way ANOVA</span>
m1 &lt;-<span class="st"> </span><span class="kw">aov</span>(chinese <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>class, <span class="dt">data =</span> df)
<span class="kw">summary</span>(m1)</code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## sex          1   39.0   39.03   3.084 0.0823 .
## class        3   55.5   18.50   1.461 0.2300  
## Residuals   95 1202.4   12.66                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m2 &lt;-<span class="st"> </span><span class="kw">aov</span>(chinese <span class="op">~</span><span class="st"> </span>sex <span class="op">*</span><span class="st"> </span>class, <span class="dt">data =</span> df)
<span class="kw">summary</span>(m2)</code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## sex          1   39.0   39.03   3.127 0.0803 .
## class        3   55.5   18.50   1.482 0.2247  
## sex:class    3   53.9   17.96   1.439 0.2367  
## Residuals   92 1148.5   12.48                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m3 &lt;-<span class="st"> </span><span class="kw">aov</span>(chinese <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>class <span class="op">+</span><span class="st"> </span>sex<span class="op">:</span>class, <span class="dt">data =</span> df)<span class="co"># same as model2</span>
<span class="kw">summary</span>(m3)</code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## sex          1   39.0   39.03   3.127 0.0803 .
## class        3   55.5   18.50   1.482 0.2247  
## sex:class    3   53.9   17.96   1.439 0.2367  
## Residuals   92 1148.5   12.48                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">TukeyHSD</span>(m1)</code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = chinese ~ sex + class, data = df)
## 
## $sex
##          diff       lwr      upr     p adj
## m-f -1.250558 -2.664252 0.163135 0.0822837
## 
## $class
##           diff       lwr       upr     p adj
## 2-1 -1.9639823 -4.595426 0.6674619 0.2137935
## 3-1 -0.5633951 -3.194839 2.0680490 0.9436202
## 4-1 -1.2885630 -3.920007 1.3428812 0.5775059
## 3-2  1.4005872 -1.230857 4.0320314 0.5075306
## 4-2  0.6754193 -1.956025 3.3068635 0.9077030
## 4-3 -0.7251679 -3.356612 1.9062763 0.8886383</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">TukeyHSD</span>(m2)</code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = chinese ~ sex * class, data = df)
## 
## $sex
##          diff       lwr       upr     p adj
## m-f -1.250558 -2.655154 0.1540377 0.0803292
## 
## $class
##           diff       lwr       upr     p adj
## 2-1 -1.9639823 -4.578914 0.6509497 0.2087355
## 3-1 -0.5633951 -3.178327 2.0515369 0.9425307
## 4-1 -1.2885630 -3.903495 1.3263690 0.5719910
## 3-2  1.4005872 -1.214345 4.0155192 0.5016692
## 4-2  0.6754193 -1.939513 3.2903513 0.9059878
## 4-3 -0.7251679 -3.340100 1.8897642 0.8866092
## 
## $`sex:class`
##                diff       lwr       upr     p adj
## m:1-f:1 -2.58229832 -7.056501 1.8919046 0.6282032
## f:2-f:1 -3.63281829 -7.983287 0.7176500 0.1729605
## m:2-f:1 -2.85455519 -6.927239 1.2181283 0.3769696
## f:3-f:1 -1.65788677 -5.810801 2.4950280 0.9181857
## m:3-f:1 -1.73803745 -5.982639 2.5065641 0.9074712
## f:4-f:1 -1.21491459 -5.367829 2.9380001 0.9846559
## m:4-f:1 -3.72869043 -7.973292 0.5159112 0.1283486
## f:2-m:1 -1.05051997 -5.839076 3.7380364 0.9973267
## m:2-m:1 -0.27225687 -4.809927 4.2654131 0.9999996
## f:3-m:1  0.92441155 -3.685404 5.5342271 0.9984902
## m:3-m:1  0.84426087 -3.848323 5.5368445 0.9992518
## f:4-m:1  1.36738373 -3.242432 5.9771992 0.9833767
## m:4-m:1 -1.14639212 -5.838976 3.5461915 0.9947772
## m:2-f:2  0.77826310 -3.637451 5.1939772 0.9993459
## f:3-f:2  1.97493152 -2.514888 6.4647513 0.8707891
## m:3-f:2  1.89478084 -2.679979 6.4695402 0.9022694
## f:4-f:2  2.41790370 -2.071916 6.9077234 0.7059934
## m:4-f:2 -0.09587215 -4.670632 4.4788872 1.0000000
## f:3-m:2  1.19666842 -3.024547 5.4178836 0.9872271
## m:3-m:2  1.11651773 -3.194932 5.4279676 0.9925491
## f:4-m:2  1.63964060 -2.581575 5.8608558 0.9285472
## m:4-m:2 -0.87413525 -5.185585 3.4373146 0.9983801
## m:3-f:3 -0.08015068 -4.467468 4.3071663 1.0000000
## f:4-f:3  0.44297218 -3.855703 4.7416473 0.9999822
## m:4-f:3 -2.07080367 -6.458121 2.3165133 0.8241941
## f:4-m:3  0.52312287 -3.864194 4.9104398 0.9999519
## m:4-m:3 -1.99065298 -6.464856 2.4835499 0.8639872
## m:4-f:4 -2.51377585 -6.901093 1.8735411 0.6368298</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="covariation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistical-modeling-and-model-interpretation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-Simple_stats.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
